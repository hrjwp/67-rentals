
{% set user_email = session.get('user') %}
{% set display_name = session.get('user_name') %}
{% if not display_name and user_email %}
    {% set display_name = user_email.split('@')[0] %}
{% endif %}
{% set current_endpoint = request.endpoint or '' %}

{% set nav_items = [
    {'label': 'Home', 'href': url_for('dashboard'), 'id': 'home', 'endpoints': ['dashboard']},
    {'label': 'Dashboard', 'href': url_for('dashboard'), 'id': 'dashboard', 'endpoints': ['dashboard']},
    {'label': 'Accounts', 'href': url_for('accounts'), 'id': 'accounts', 'endpoints': ['accounts', 'admin_panel']},
    {'label': 'Management', 'href': url_for('vehicles_page'), 'id': 'management', 'endpoints': ['vehicles_page', 'vehicle_management']},
    {'label': 'Security', 'href': url_for('security_dashboard'), 'id': 'security', 'endpoints': ['security_dashboard', 'security_logs', 'audit_logs', 'vehicle_fraud_logs', 'booking_fraud_logs', 'submitted_cases', 'data_classification', 'data_retention', 'data_retention_dashboard']}
] %}

<nav id="navbar">
        <div class="nav-container" style="display: flex; align-items: center; justify-content: flex-start; gap: 40px;">
        <a href="{{ url_for('dashboard') }}" class="logo">
            <span class="logo-text">67 Rentals</span>
        </a>
            <ul class="nav-links">
                <li><a href="{{ url_for('dashboard') }}">Home</a></li>
                <li><a href="{{ url_for('dashboard') }}" class="active">Dashboard</a></li>
                <li><a href="{{ url_for('accounts') }}">Accounts</a></li>
                <li><a href="{{ url_for('vehicles_page') }}">Management</a></li>
                <li><a href="{{ url_for('security_dashboard') }}">Security</a></li>
            </ul>
            <div class="d-flex align-items-center gap-3">
                {% set admin_name = session.get('user_name') or session.get('user', 'Admin') %}
                {% if '@' in admin_name %}
                {% set admin_name = admin_name.split('@')[0] %}
                {% endif %}
                <a href="{{ url_for('profile') }}" class="cta-button secondary" style="padding:10px 16px; background: #F2CC8F; color: #3D405B">
                    <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"
                        style="margin-right:6px;vertical-align:middle;">
                        <path
                            d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                    </svg>
                    {{ admin_name }}
                </a>
                <a href="{{ url_for('logout') }}" class="cta-button secondary" style="padding:10px 16px; margin-left: 10px; background: #F2CC8F; color: #3D405B;">Logout</a>
            </div>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        <ul class="nav-links-mobile" id="navLinksMobile">
            <li><a href="{{ url_for('dashboard') }}">Home</a></li>
            <li><a href="{{ url_for('dashboard') }}" class="active">Dashboard</a></li>
            <li><a href="{{ url_for('accounts') }}">Accounts</a></li>
            <li><a href="{{ url_for('vehicles_page') }}">Management</a></li>
            <li><a href="{{ url_for('security_dashboard') }}">Security</a></li>
            <li><a href="{{ url_for('profile') }}">Profile</a></li>
            <li><a href="{{ url_for('logout') }}">Logout</a></li>
        </ul>
    </nav>
