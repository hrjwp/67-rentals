<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Cancel Booking - 67 Rentals</title>

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
        <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
        <link href="{{ url_for('static', filename='css/bootstrap-icons.css') }}" rel="stylesheet">
        <link href="{{ url_for('static', filename='css/templatemo-tiya-golf-club.css') }}" rel="stylesheet">

        <style>
            .navbar {
                background-color: #3D405B !important;
                padding: 20px 0;
            }

            .navbar-brand-text {
                color: #ffffff;
                font-size: 28px;
                font-weight: 700;
            }

            .navbar-brand-text small {
                display: block;
                font-size: 14px;
                font-weight: 400;
            }

            .nav-link {
                color: #ffffff !important;
                font-weight: 500;
                padding: 10px 20px !important;
            }

            .nav-link:hover {
                color: #F2CC8F !important;
            }

            .cancel-section {
                padding: 80px 0;
                min-height: 70vh;
                background-color: #ffffff;
            }

            .cancel-header h2 {
                color: #3D405B;
                font-weight: 700;
                margin-bottom: 40px;
            }

            .booking-card {
                background: #ffffff;
                border: 1px solid #e9eaeb;
                border-radius: 10px;
                padding: 30px;
                margin-bottom: 30px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            }

            .booking-card h4 {
                color: #3D405B;
                font-weight: 700;
                margin-bottom: 20px;
                padding-bottom: 15px;
                border-bottom: 2px solid #81B29A;
            }

            .booking-details {
                background-color: #F4F1DE;
                border-radius: 10px;
                padding: 25px;
                margin-bottom: 25px;
            }

            .booking-details h5 {
                color: #3D405B;
                font-weight: 700;
                margin-bottom: 15px;
            }

            .detail-row {
                display: flex;
                justify-content: space-between;
                padding: 10px 0;
                border-bottom: 1px solid #e9eaeb;
            }

            .detail-row:last-child {
                border-bottom: none;
            }

            .detail-label {
                color: #717275;
                font-weight: 600;
            }

            .detail-value {
                color: #3D405B;
                font-weight: 700;
            }

            .refund-policy {
                background-color: #fff3cd;
                border-left: 4px solid #F2CC8F;
                padding: 20px;
                border-radius: 5px;
                margin-bottom: 25px;
            }

            .refund-policy h5 {
                color: #3D405B;
                font-weight: 700;
                margin-bottom: 15px;
            }

            .refund-policy ul {
                margin-bottom: 0;
                padding-left: 20px;
            }

            .refund-policy li {
                color: #717275;
                margin-bottom: 8px;
            }

            .form-label {
                color: #3D405B;
                font-weight: 600;
                margin-bottom: 8px;
            }

            .form-control, .form-select {
                border: 1px solid #e9eaeb;
                border-radius: 5px;
                padding: 12px;
            }

            .form-control:focus, .form-select:focus {
                border-color: #81B29A;
                box-shadow: 0 0 0 0.2rem rgba(129, 178, 154, 0.25);
            }

            textarea.form-control {
                min-height: 120px;
            }

            .alert-warning {
                background-color: #fff3cd;
                border-color: #F2CC8F;
                color: #856404;
            }

            .btn-cancel {
                background-color: #dc3545;
                color: #ffffff;
                border: none;
                padding: 15px 40px;
                border-radius: 5px;
                font-weight: 700;
                font-size: 16px;
                transition: all 0.3s ease;
            }

            .btn-cancel:hover {
                background-color: #c82333;
                color: #ffffff;
                transform: translateY(-2px);
            }

            .btn-back {
                background-color: #6c757d;
                color: #ffffff;
                border: none;
                padding: 15px 40px;
                border-radius: 5px;
                font-weight: 700;
                font-size: 16px;
                transition: all 0.3s ease;
                text-decoration: none;
            }

            .btn-back:hover {
                background-color: #5a6268;
                color: #ffffff;
            }

            .badge-status {
                padding: 8px 15px;
                border-radius: 20px;
                font-size: 14px;
                font-weight: 600;
            }

            .badge-confirmed {
                background-color: #81B29A;
                color: white;
            }

            .vehicle-image {
                width: 100%;
                max-width: 150px;
                height: 100px;
                object-fit: contain;
                background-color: #f9f9f9;
                border-radius: 8px;
                padding: 10px;
            }
        </style>
    </head>

    <body>
        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <a class="navbar-brand d-flex align-items-center" href="{{ url_for('index_logged') }}">
                    <img src="{{ url_for('static', filename='images/logo.png') }}" class="navbar-brand-image img-fluid" alt="67 Rentals" style="width: 50px;">
                    <span class="navbar-brand-text">
                        67
                        <small>Rentals</small>
                    </span>
                </a>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-lg-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('index_logged') }}">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">My Bookings</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <section class="cancel-section">
            <div class="container">
                <div class="cancel-header">
                    <h2><i class="bi bi-x-circle"></i> Cancel Booking & Request Refund</h2>
                </div>

                <div class="row">
                    <div class="col-lg-8">
                        <!-- Booking Information -->
                        <div class="booking-card">
                            <h4><i class="bi bi-info-circle"></i> Booking Information</h4>

                            <div class="row align-items-center mb-4">
                                <div class="col-md-3">
                                    <img src="{{ url_for('static', filename=booking.vehicle_image) }}" class="vehicle-image" alt="{{ booking.vehicle_name }}">
                                </div>
                                <div class="col-md-9">
                                    <h5 style="color: #3D405B; font-weight: 700;">{{ booking.vehicle_name }}</h5>
                                    <p class="mb-1">
                                        <span class="badge-status badge-confirmed">{{ booking.status }}</span>
                                    </p>
                                    <p class="mb-0" style="color: #717275;">
                                        <i class="bi bi-calendar-check"></i> {{ booking.pickup_date }} to {{ booking.return_date }}<br>
                                        <i class="bi bi-geo-alt"></i> {{ booking.pickup_location }}
                                    </p>
                                </div>
                            </div>

                            <div class="booking-details">
                                <h5>Booking Details</h5>
                                <div class="detail-row">
                                    <span class="detail-label">Booking ID:</span>
                                    <span class="detail-value">{{ booking.booking_id }}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Booking Date:</span>
                                    <span class="detail-value">{{ booking.booking_date }}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Rental Duration:</span>
                                    <span class="detail-value">{{ booking.days }} days</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Total Amount Paid:</span>
                                    <span class="detail-value">${{ booking.total_amount }}</span>
                                </div>
                            </div>

                            <!-- Refund Policy -->
                            <div class="refund-policy">
                                <h5><i class="bi bi-shield-exclamation"></i> Cancellation & Refund Policy</h5>
                                <ul>
                                    <li><strong>More than 7 days before pickup:</strong> 100% refund</li>
                                    <li><strong>3-7 days before pickup:</strong> 50% refund</li>
                                    <li><strong>Less than 3 days before pickup:</strong> No refund</li>
                                    <li><strong>Processing time:</strong> Refunds typically take 5-10 business days</li>
                                </ul>
                            </div>

                            <!-- Cancellation Form -->
                            <form method="POST" action="{{ url_for('submit_cancellation', booking_id=booking.booking_id) }}">
                                <div class="mb-3">
                                    <label class="form-label">Reason for Cancellation *</label>
                                    <select class="form-select" name="cancellation_reason" required>
                                        <option value="">Select a reason...</option>
                                        <option value="change_of_plans">Change of Plans</option>
                                        <option value="found_alternative">Found Alternative Vehicle</option>
                                        <option value="emergency">Emergency/Urgent Matter</option>
                                        <option value="price_concern">Price Concern</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Additional Details *</label>
                                    <textarea class="form-control" name="cancellation_details" placeholder="Please provide more information about your cancellation request..." required></textarea>
                                </div>

                                <div class="alert alert-warning">
                                    <i class="bi bi-exclamation-triangle-fill"></i>
                                    <strong>Important:</strong> Once you submit this cancellation request, your booking will be marked as "Pending Cancellation" and will be reviewed by our team. You will receive an email notification once your request is processed.
                                </div>

                                <div class="d-flex gap-3 mt-4">
                                    <button type="submit" class="btn-cancel">
                                        <i class="bi bi-x-circle"></i> Submit Cancellation Request
                                    </button>
                                    <a href="#" class="btn-back">
                                        <i class="bi bi-arrow-left"></i> Back to Bookings
                                    </a>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <!-- Estimated Refund -->
                        <div class="booking-card" style="background-color: #F4F1DE;">
                            <h4><i class="bi bi-calculator"></i> Estimated Refund</h4>

                            <div class="detail-row">
                                <span class="detail-label">Original Amount:</span>
                                <span class="detail-value">${{ booking.total_amount }}</span>
                            </div>

                            <div class="detail-row">
                                <span class="detail-label">Refund Percentage:</span>
                                <span class="detail-value">{{ refund_percentage }}%</span>
                            </div>

                            <div class="detail-row">
                                <span class="detail-label">Processing Fee:</span>
                                <span class="detail-value">-${{ processing_fee }}</span>
                            </div>

                            <div class="detail-row" style="font-size: 20px; padding-top: 20px; margin-top: 15px; border-top: 2px solid #3D405B;">
                                <span class="detail-label">Estimated Refund:</span>
                                <span class="detail-value" style="color: #81B29A;">${{ estimated_refund }}</span>
                            </div>

                            <div class="alert alert-info mt-4" style="background-color: #e3f2fd; border-color: #81B29A; color: #0c5460;">
                                <small>
                                    <i class="bi bi-info-circle"></i>
                                    The final refund amount will be determined by our team based on our cancellation policy and the timing of your request.
                                </small>
                            </div>
                        </div>

                        <!-- Contact Support -->
                        <div class="booking-card">
                            <h4><i class="bi bi-headset"></i> Need Help?</h4>
                            <p style="color: #717275;">If you have questions about cancellation or refunds, our support team is here to help.</p>
                            <p class="mb-1">
                                <i class="bi bi-telephone"></i> <strong>(65) 6600-6655</strong>
                            </p>
                            <p class="mb-0">
                                <i class="bi bi-envelope"></i> <strong>67Rentals@company.com</strong>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer class="site-footer" style="background-color: #3D405B; color: white; padding: 40px 0;">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-12 text-center text-lg-start mb-3">
                        <span class="navbar-brand-text">
                            67
                            <small>Rentals</small>
                        </span>
                    </div>
                    <div class="col-lg-6 col-12 text-center text-lg-end">
                        <p class="mb-0">Copyright Â© 2048 67 Rentals</p>
                    </div>
                </div>
            </div>
        </footer>

        <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
        <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
        <script>
            // Confirm before submitting cancellation
            document.querySelector('form').addEventListener('submit', function(e) {
                if (!confirm('Are you sure you want to cancel this booking? This action cannot be undone.')) {
                    e.preventDefault();
                }
            });
        </script>
    </body>
</html>